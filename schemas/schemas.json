{
  "required": [
    "Config",
    "User",
    "CredentialCreation",
    "CredentialCreationResponse",
    "CredentialAssertion",
    "CredentialAssertionResponse",
    "SessionData"
  ],
  "properties": {
    "Config": {
      "$ref": "#/definitions/Config"
    },
    "User": {
      "$ref": "#/definitions/User"
    },
    "CredentialCreation": {
      "$ref": "#/definitions/CredentialCreation"
    },
    "CredentialCreationResponse": {
      "$ref": "#/definitions/CredentialCreationResponse"
    },
    "CredentialAssertion": {
      "$ref": "#/definitions/CredentialAssertion"
    },
    "CredentialAssertionResponse": {
      "$ref": "#/definitions/CredentialAssertionResponse"
    },
    "SessionData": {
      "$ref": "#/definitions/SessionData"
    }
  },
  "additionalProperties": false,
  "type": "object",
  "definitions": {
    "Authenticator": {
      "required": [
        "AAGUID",
        "SignCount",
        "CloneWarning"
      ],
      "properties": {
        "AAGUID": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          },
          "description": "Identifies the type (e.g. make and model) of the authenticator."
        },
        "SignCount": {
          "type": "integer",
          "description": "{@link finishLogin} compares the stored signature counter value with the new `signCount` value returned in the assertion’s authenticator data. If this new `signCount` value is less than or equal to the stored value, a cloned authenticator may exist, or the authenticator may be malfunctioning."
        },
        "CloneWarning": {
          "type": "boolean",
          "description": "This is a signal that the authenticator may be cloned, i.e. at least two copies of the credential private key may exist and are being used in parallel. Relying Parties (applications) should incorporate this information into their risk scoring. Whether the Relying Party updates the stored signature counter value in this case, or not, or fails the authentication ceremony or not, is Relying Party-specific."
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "Represents the user's authenticator device."
    },
    "AuthenticatorAssertionResponse": {
      "required": [
        "clientDataJSON",
        "authenticatorData",
        "signature"
      ],
      "properties": {
        "clientDataJSON": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          },
          "description": "Contains a JSON serialization of the client data passed to the authenticator by the browser in its call to navigator.credentials.get()."
        },
        "authenticatorData": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          },
          "description": "Serialized bindings made by the authenticator, such as ID of the Relying Party that the credential is meant for, whether the user is present and the signature count."
        },
        "signature": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          },
          "description": "The raw signature returned from the authenticator."
        },
        "userHandle": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          },
          "description": "Contains the Relying Party's ID for the user"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "Contains the raw authenticator assertion data, used to verify the authenticity of the login ceremony and the used credential."
    },
    "AuthenticatorAttestationResponse": {
      "required": [
        "clientDataJSON",
        "attestationObject"
      ],
      "properties": {
        "clientDataJSON": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          },
          "description": "Contains a JSON serialization of the client data passed to the authenticator by the browser in its call to navigator.credentials.create()."
        },
        "attestationObject": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          },
          "description": "This attribute contains an attestation object, which is opaque to, and cryptographically protected against tampering by, the browser. The attestation object contains both authenticator data and an attestation statement. The former contains the AAGUID, a unique credential ID, and the credential public key. The contents of the attestation statement are determined by the attestation statement format used by the authenticator.  It also contains any additional information that the Relying Party's server requires to validate the attestation statement, as well as to decode and validate the authenticator data along with the JSON-serialized client data."
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "Contains the raw authenticator attestation data, used to verify the authenticy of the registration ceremony and the new credential."
    },
    "AuthenticatorSelection": {
      "properties": {
        "authenticatorAttachment": {
          "type": "string",
          "description": "If this member is present, eligible authenticators are filtered to only authenticators attached by the specified mechanism.",
          "oneOf": [
            {
              "$ref": "#/definitions/PlatformAttachment"
            },
            {
              "$ref": "#/definitions/CrossPlatformAttachment"
            }
          ]
        },
        "requireResidentKey": {
          "type": "boolean",
          "description": "Describes the Relying Party's requirements regarding resident credentials. If present and set to `true`, the authenticator MUST create a client-side-resident public key credential source when creating a public key credential."
        },
        "userVerification": {
          "type": "string",
          "description": "Describes the Relying Party's requirements regarding user verification for the `navigator.credentials.create()` or `navigator.credentials.get()` operation. Eligible authenticators are filtered to only those capable of satisfying this requirement.",
          "oneOf": [
            {
              "$ref": "#/definitions/UserVerificationRequired"
            },
            {
              "$ref": "#/definitions/UserVerificationPreferred"
            },
            {
              "$ref": "#/definitions/UserVerificationDiscouraged"
            }
          ],
          "default": "preferred"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "Use this class to specify requirements regarding authenticator attributes."
    },
    "Config": {
      "required": [
        "RPDisplayName",
        "RPID"
      ],
      "properties": {
        "RPDisplayName": {
          "type": "string",
          "description": "Friendly name for the Relying Party (application). The browser may display this to the user."
        },
        "RPID": {
          "type": "string",
          "description": "A valid domain that identifies the Relying Party. A credential can only by used  with the same enity (as identified by the `RPID`) it was registered with."
        },
        "RPOrigin": {
          "type": "string",
          "description": "The HTTP(S) origin that the Relying Party is using to handle requests"
        },
        "RPIcon": {
          "type": "string",
          "description": "URL to an icon representing the Relying Party"
        },
        "AttestationPreference": {
          "type": "string",
          "description": "Preferred attestation conveyance during credential generation",
          "oneOf": [
            {
              "$ref": "#/definitions/PreferNoAttestation"
            },
            {
              "$ref": "#/definitions/PreferIndirectAttestation"
            },
            {
              "$ref": "#/definitions/PreferDirectAttestation"
            }
          ],
          "default": "none"
        },
        "AuthenticatorSelection": {
          "$ref": "#/definitions/AuthenticatorSelection",
          "description": "Login requirements for authenticator attributes."
        },
        "Timeout": {
          "type": "integer",
          "description": "Timeout for browser `navigator.credentials.create()` and `navigator.credentials.debug()` in the browser."
        },
        "Debug": {
          "type": "boolean",
          "description": "@ignore"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "Configuration and default values for the {@link WebAuthn4JS} instance."
    },
    "Credential": {
      "required": [
        "ID",
        "PublicKey",
        "AttestationType",
        "Authenticator"
      ],
      "properties": {
        "ID": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          },
          "description": "A probabilistically-unique byte sequence identifying a public key credential source and its authentication assertions."
        },
        "PublicKey": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          },
          "description": "The public key portion of a Relying Party-specific credential key pair, generated by an authenticator and returned to a Relying Party at registration time."
        },
        "AttestationType": {
          "type": "string",
          "description": "The attestation format used (if any) by the authenticator when creating the credential."
        },
        "Authenticator": {
          "$ref": "#/definitions/Authenticator",
          "description": "The Authenticator information for a given certificate."
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "Contains all needed information about a WebAuthn credential for storage."
    },
    "CredentialAssertion": {
      "required": [
        "publicKey"
      ],
      "properties": {
        "publicKey": {
          "$ref": "#/definitions/PublicKeyCredentialRequestOptions",
          "description": "Options for the browser to pass to `navigator.credentials.get()`."
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "The payload that should be sent to the browser for beginning the login process."
    },
    "CredentialAssertionResponse": {
      "required": [
        "id",
        "type",
        "rawId",
        "response"
      ],
      "properties": {
        "id": {
          "type": "string",
          "description": "The credential's identifier."
        },
        "type": {
          "type": "string",
          "description": "Specifies the credential type represented by this object.",
          "oneOf": [
            {
              "$ref": "#/definitions/PublicKeyCredentialType"
            }
          ]
        },
        "rawId": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          },
          "description": "The credential's identifier. Since we base64-encode raw data, this is the same as `id`."
        },
        "extensions": {
          "patternProperties": {
            ".*": {
              "additionalProperties": true
            }
          },
          "type": "object",
          "description": "A map containing identifier -> client extension output entries produced by any extensions that may have been used during login."
        },
        "response": {
          "$ref": "#/definitions/AuthenticatorAssertionResponse",
          "description": "The authenticator's response to the request to generate a login assertion."
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "The raw response returned to us from an authenticator when we request a credential for login."
    },
    "CredentialCreation": {
      "required": [
        "publicKey"
      ],
      "properties": {
        "publicKey": {
          "$ref": "#/definitions/PublicKeyCredentialCreationOptions",
          "description": "Options for the browser to pass to `navigator.credentials.create()`."
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "The payload that should be sent to the browser for beginning the registration process."
    },
    "CredentialCreationResponse": {
      "required": [
        "id",
        "type",
        "rawId",
        "response"
      ],
      "properties": {
        "id": {
          "type": "string",
          "description": "The credential's identifier."
        },
        "type": {
          "type": "string",
          "description": "Specifies the credential type represented by this object.",
          "oneOf": [
            {
              "$ref": "#/definitions/PublicKeyCredentialType"
            }
          ]
        },
        "rawId": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          },
          "description": "The credential's identifier. Since we base64-encode raw data, this is the same as `id`."
        },
        "extensions": {
          "patternProperties": {
            ".*": {
              "additionalProperties": true
            }
          },
          "type": "object",
          "description": "A map containing identifier -> client extension output entries produced by any extensions that may have been used during registration."
        },
        "response": {
          "$ref": "#/definitions/AuthenticatorAttestationResponse",
          "description": "The authenticator's response to the request to generate a registration attestation."
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "The raw response returned to us from an authenticator when we request a credential for registration."
    },
    "CredentialDescriptor": {
      "required": [
        "type",
        "id"
      ],
      "properties": {
        "type": {
          "type": "string",
          "description": "Type of the credential to use.",
          "oneOf": [
            {
              "$ref": "#/definitions/PublicKeyCredentialType"
            }
          ]
        },
        "id": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          },
          "description": "The ID of a credential to allow/disallow."
        },
        "transports": {
          "items": {
            "type": "string"
          },
          "type": "array",
          "description": "Contains a hint as to how the browser might communicate with the authenticator to which the credential belongs."
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "Specifies a credential for use by the browser when it calls `navigator.credentials.create()` or `navigator.credentials.get()`."
    },
    "CredentialParameter": {
      "required": [
        "type",
        "alg"
      ],
      "properties": {
        "type": {
          "type": "string",
          "description": "Type of the credential to use.",
          "oneOf": [
            {
              "$ref": "#/definitions/PublicKeyCredentialType"
            }
          ]
        },
        "alg": {
          "type": "integer",
          "description": "Algorithm to use, see the [IANA CBOR COSE Algorithms Registry](https://www.iana.org/assignments/cose/cose.xhtml#algorithms)",
          "oneOf": [
            {
              "$ref": "#/definitions/AlgES256"
            },
            {
              "$ref": "#/definitions/AlgES384"
            },
            {
              "$ref": "#/definitions/AlgES512"
            },
            {
              "$ref": "#/definitions/AlgRS1"
            },
            {
              "$ref": "#/definitions/AlgRS256"
            },
            {
              "$ref": "#/definitions/AlgRS384"
            },
            {
              "$ref": "#/definitions/AlgRS512"
            },
            {
              "$ref": "#/definitions/AlgPS256"
            },
            {
              "$ref": "#/definitions/AlgPS384"
            },
            {
              "$ref": "#/definitions/AlgPS512"
            },
            {
              "$ref": "#/definitions/AlgEdDSA"
            }
          ]
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "The credential type and algorithm that the relying party wants the authenticator to create."
    },
    "PublicKeyCredentialCreationOptions": {
      "required": [
        "challenge",
        "rp",
        "user"
      ],
      "properties": {
        "challenge": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          }
        },
        "rp": {
          "$ref": "#/definitions/RelyingPartyEntity"
        },
        "user": {
          "$ref": "#/definitions/UserEntity"
        },
        "pubKeyCredParams": {
          "items": {
            "$ref": "#/definitions/CredentialParameter"
          },
          "type": "array"
        },
        "authenticatorSelection": {
          "$ref": "#/definitions/AuthenticatorSelection",
          "description": "Registration requirements for authenticator attributes."
        },
        "timeout": {
          "type": "integer"
        },
        "excludeCredentials": {
          "items": {
            "$ref": "#/definitions/CredentialDescriptor"
          },
          "type": "array"
        },
        "extensions": {
          "patternProperties": {
            ".*": {
              "additionalProperties": true
            }
          },
          "type": "object"
        },
        "attestation": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "Parameters for `navigator.credentials.create()`."
    },
    "PublicKeyCredentialRequestOptions": {
      "required": [
        "challenge"
      ],
      "properties": {
        "challenge": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          }
        },
        "timeout": {
          "type": "integer"
        },
        "rpId": {
          "type": "string"
        },
        "allowCredentials": {
          "items": {
            "$ref": "#/definitions/CredentialDescriptor"
          },
          "type": "array"
        },
        "userVerification": {
          "type": "string"
        },
        "extensions": {
          "patternProperties": {
            ".*": {
              "additionalProperties": true
            }
          },
          "type": "object"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "FOOBAR"
    },
    "RelyingPartyEntity": {
      "required": [
        "name",
        "id"
      ],
      "properties": {
        "name": {
          "type": "string"
        },
        "icon": {
          "type": "string"
        },
        "id": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "SessionData": {
      "required": [
        "challenge",
        "user_id",
        "userVerification"
      ],
      "properties": {
        "challenge": {
          "type": "string"
        },
        "user_id": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          }
        },
        "allowed_credentials": {
          "items": {
            "type": "string",
            "media": {
              "binaryEncoding": "base64"
            }
          },
          "type": "array"
        },
        "userVerification": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "User": {
      "required": [
        "id",
        "name",
        "displayName",
        "iconURL",
        "credentials"
      ],
      "properties": {
        "id": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          }
        },
        "name": {
          "type": "string"
        },
        "displayName": {
          "type": "string"
        },
        "iconURL": {
          "type": "string"
        },
        "credentials": {
          "items": {
            "$ref": "#/definitions/Credential"
          },
          "type": "array"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "UserEntity": {
      "required": [
        "name",
        "id"
      ],
      "properties": {
        "name": {
          "type": "string"
        },
        "icon": {
          "type": "string"
        },
        "displayName": {
          "type": "string"
        },
        "id": {
          "type": "string",
          "media": {
            "binaryEncoding": "base64"
          }
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "PlatformAttachment": {
      "enum": [
        "platform"
      ],
      "description": "A platform authenticator is attached using a client device-specific transport, called platform attachment, and is usually not removable from the client device. A public key credential bound to a platform authenticator is called a platform credential."
    },
    "CrossPlatformAttachment": {
      "enum": [
        "cross-platform"
      ],
      "description": "A roaming authenticator is attached using cross-platform transports, called cross-platform attachment. Authenticators of this class are removable from, and can \"roam\" among, client devices. A public key credential bound to a roaming authenticator is called a roaming credential."
    },
    "UserVerificationRequired": {
      "enum": [
        "required"
      ],
      "description": "User verification is required to create/use a credential."
    },
    "UserVerificationPreferred": {
      "enum": [
        "preferred"
      ],
      "description": "User verification is preferred to create/use a credential. This is the default if no user verification requirement is specified."
    },
    "UserVerificationDiscouraged": {
      "enum": [
        "discouraged"
      ],
      "description": "The authenticator should not verify the user for the credential."
    },
    "PreferNoAttestation": {
      "description": "Indicates that the Relying Party is not interested in authenticator attestation. For example, in order to potentially avoid having to obtain user consent to relay identifying information to the Relying Party, or to save a roundtrip to an Attestation CA. This is the default if no attestation conveyance is specified.",
      "enum": [
        "none"
      ]
    },
    "PreferIndirectAttestation": {
      "description": "Indicates that the Relying Party prefers an attestation conveyance yielding verifiable attestation statements, but allows the client to decide how to obtain such attestation statements. The client MAY replace the authenticator-generated attestation statements with attestation statements generated by an Anonymization CA, in order to protect the user’s privacy, or to assist Relying Parties with attestation verification in a heterogeneous ecosystem.",
      "enum": [
        "indirect"
      ]
    },
    "PreferDirectAttestation": {
      "description": "Indicates that the Relying Party wants to receive the attestation statement as generated by the authenticator.",
      "enum": [
        "direct"
      ]
    },
    "PublicKeyCredentialType": {
      "description": "Credential type for WebAuthn.",
      "enum": [
        "public-key"
      ]
    },
    "AlgES256": {
      "description": "ECDSA with SHA-256",
      "enum": [
        -7
      ]
    },
    "AlgES384": {
      "description": "ECDSA with SHA-384",
      "enum": [
        -35
      ]
    },
    "AlgES512": {
      "description": "ECDSA with SHA-512",
      "enum": [
        -36
      ]
    },
    "AlgRS1": {
      "description": "RSASSA-PKCS1-v1_5 with SHA-1",
      "enum": [
        -65535
      ]
    },
    "AlgRS256": {
      "description": "RSASSA-PKCS1-v1_5 with SHA-256",
      "enum": [
        -257
      ]
    },
    "AlgRS384": {
      "description": "RSASSA-PKCS1-v1_5 with SHA-384",
      "enum": [
        -258
      ]
    },
    "AlgRS512": {
      "description": "RSASSA-PKCS1-v1_5 with SHA-512",
      "enum": [
        -259
      ]
    },
    "AlgPS256": {
      "description": "RSASSA-PSS with SHA-256",
      "enum": [
        -37
      ]
    },
    "AlgPS384": {
      "description": "RSASSA-PSS with SHA-384",
      "enum": [
        -38
      ]
    },
    "AlgPS512": {
      "description": "RSASSA-PSS with SHA-512",
      "enum": [
        -39
      ]
    },
    "AlgEdDSA": {
      "description": "EdDSA",
      "enum": [
        -8
      ]
    }
  }
}
